{%- if section.settings.divider -%}<div class="section--divider">{%- endif -%}

<div class="bg bg--{{section.id}}">
  <div class="page-width">
    {%- if section.settings.title != blank -%}
      <div class="section-header text-{{ section.settings.align_text }}">
        <h2>{{ section.settings.title }}</h2>
      </div>
    {%- endif -%}

    <div class="grid {% if section.blocks.size == 4 %}grid--4-col-desktop grid--2-col-tablet grid--1-col-mobile {% endif %} {% if section.blocks.size == 3 %}grid--3-col-desktop grid--2-col-tablet grid--1-col-mobile{% endif %} {% unless section.blocks.size == 5 %} grid--uniform{% endunless %} grid--2-col-tablet-down grid--flush-bottom">
      {%- liquid
        assign grid_item_width = 'medium-up--one-third'
        case section.blocks.size
          when 1
            assign grid_item_width = 'medium-up--one-half'
          when 2
            assign grid_item_width = 'medium-up--one-half'
          when 4
            assign grid_item_width = 'medium-up--one-quarter small--one-half'
        endcase
      -%}
      {%- for block in section.blocks -%}
        {%- if section.blocks.size == 5 and forloop.index < 3 -%}
          {%- assign column_width = 'medium-up--one-half' -%}
        {%- else -%}
          {%- assign column_width = grid_item_width -%}
        {%- endif -%}
        <div
          class="grid__item {{ column_width }} text-{{ section.settings.align_text }}"
          {{ block.shopify_attributes }}
          data-aos="row-of-3"
        >
          {%- if block.settings.enable_image -%}
            <div style="{% if section.settings.align_text == 'center' %}margin: 0 auto;{% endif %} max-width: {{ block.settings.image_width }}px;">
              {%- if block.settings.button_link != blank -%}
                <a href="{{ block.settings.button_link }}" aria-label="block-image">
              {%- endif -%}
              {%- if block.settings.image != blank -%}
                <div
                  class="image-wrp text-spacing"
                  style="height: 0; padding-bottom: {{ 100 | divided_by: block.settings.image.aspect_ratio }}%;"
                >
                  {%- assign img_url = block.settings.image | img_url: '1x1' | replace: '_1x1.', '_{width}x.' -%}
                  <img
                    class="circle-img"
                    src="{{ block.settings.image | img_url: '150x' }}"
                    alt="{{ block.settings.image.alt }}"
                    class:image_class,
                    loading:lazy,
                    width="114"
                    height="114"
                  >
                </div>
              {%- else -%}
                <div class="image-wrap text-spacing">{{ 'image' | placeholder_svg_tag: 'placeholder-svg' }}</div>
              {%- endif -%}
              {%- if block.settings.button_link != blank -%}
                </a>
              {%- endif -%}
            </div>
          {%- endif -%}
          {%- if block.settings.title != blank -%}
            <h3 class="h2">{{ block.settings.title }}</h3>
          {%- endif -%}
          {%- if block.settings.text != blank -%}
            <div class="rte-setting text-spacing">{{ block.settings.text }}</div>
          {%- endif -%}
          {%- if block.settings.button_label != blank -%}
            <a href="{{ block.settings.button_link }}" class="button btn--outline btn--small">
              {{ block.settings.button_label }}
            </a>
          {%- endif -%}
        </div>
      {%- endfor -%}
    </div>

    <center>
      {%- if section.settings.button_label != blank -%}
        <br>
        <a href="{{ section.settings.button_link }}" class="button button--primary">
          {{ section.settings.button_label }}
        </a>
      {%- endif -%}
      {% if section.settings.use_cart_btn %}
        <div class="multicol-txt-cartbtn-wrap">
          <product-form
            class="product-form"
            data-hide-errors="false"
            data-section-id="{{ section.id }}"
          >
            <div class="product-form__error-message-wrapper" role="alert" hidden>
              <svg
                aria-hidden="true"
                focusable="false"
                class="icon icon-error"
                viewBox="0 0 13 13"
              >
                <circle cx="6.5" cy="6.50049" r="5.5" stroke="white" stroke-width="2"/>
                <circle cx="6.5" cy="6.5" r="5.5" fill="#EB001B" stroke="#EB001B" stroke-width="0.7"/>
                <path d="M5.87413 3.52832L5.97439 7.57216H7.02713L7.12739 3.52832H5.87413ZM6.50076 9.66091C6.88091 9.66091 7.18169 9.37267 7.18169 9.00504C7.18169 8.63742 6.88091 8.34917 6.50076 8.34917C6.12061 8.34917 5.81982 8.63742 5.81982 9.00504C5.81982 9.37267 6.12061 9.66091 6.50076 9.66091Z" fill="white"/>
                <path d="M5.87413 3.17832H5.51535L5.52424 3.537L5.6245 7.58083L5.63296 7.92216H5.97439H7.02713H7.36856L7.37702 7.58083L7.47728 3.537L7.48617 3.17832H7.12739H5.87413ZM6.50076 10.0109C7.06121 10.0109 7.5317 9.57872 7.5317 9.00504C7.5317 8.43137 7.06121 7.99918 6.50076 7.99918C5.94031 7.99918 5.46982 8.43137 5.46982 9.00504C5.46982 9.57872 5.94031 10.0109 6.50076 10.0109Z" fill="white" stroke="#EB001B" stroke-width="0.7">
              </svg>
              <span class="product-form__error-message"></span>
            </div>
            {% assign pform_id = 'product-form-' | append: section.id %}
            {%- form 'product',
              product,
              id: pform_id,
              class: 'form',
              novalidate: 'novalidate',
              data-type: 'add-to-cart-form'
            -%}
              <input
                type="hidden"
                name="id"
                value="{{ product.selected_or_first_available_variant.id }}"
                {% if product.selected_or_first_available_variant.available == false or quantity_rule_soldout %}
                  disabled
                {% endif %}
                class="product-variant-id"
              >

              {%- if gift_card_recipient_feature_active -%}
                {%- render 'gift-card-recipient-form', product: product, form: form, section: section -%}
              {%- endif -%}

              <div class="{%- if show_dynamic_checkout -%}product-form__buttons{% else %}product-form__button{% endif %}">
                {%- liquid
                  assign check_against_inventory = true
                  if product.selected_or_first_available_variant.inventory_management != 'shopify' or product.selected_or_first_available_variant.inventory_policy == 'continue'
                    assign check_against_inventory = false
                  endif
                  if product.selected_or_first_available_variant.quantity_rule.min > product.selected_or_first_available_variant.inventory_quantity and check_against_inventory
                    assign quantity_rule_soldout = true
                  endif
                -%}
                <button
                  id="ProductSubmitButton-{{ section_id }}"
                  type="submit"
                  name="add"
                  class="product-form__submit button  {% if show_dynamic_checkout %}button--secondary{% else %}button--primary{% endif %}"
                  {% if product.selected_or_first_available_variant.available == false or quantity_rule_soldout %}
                    disabled
                  {% endif %}
                >
                  <span>
                    {%- if product.selected_or_first_available_variant.available == false or quantity_rule_soldout -%}
                      {{ 'products.product.sold_out' | t }}
                    {%- else -%}
                      {{ 'products.product.add_to_cart' | t }}
                      <span class="btn_price_wrap">
                        {{- product.selected_or_first_available_variant.price | money -}}
                      </span>
                    {%- endif -%}
                  </span>
                  {%- render 'loading-spinner' -%}
                </button>
              </div>
            {%- endform -%}
          </product-form>
        </div>
      {% endif %}
    </center>
  </div>
</div>
{%- if section.settings.divider -%}</div>{%- endif -%}

<style>
    .bg {
      padding:80px 0px;
    }
    .bg--{{section.id}}{
      background:{{section.settings.bg}};
    }
    @media(max-width:1024px){
      .bg {
      padding:40px 0px;
    }
      .bg br {
      display: none;
  }
  .bg .button.button--primary {
      margin-top: 20px;
        width: 230px;
  }
    }
</style>
{% if section.settings.hide_on_mobile %}
  <style>
      @media(max-width:769px){
      .bg--{{section.id}} {
          display:none;
      }
    }
  </style>
{% endif %}
{% schema %}
{
  "name": "Text columns with images",
  "class": "index-section",
  "settings": [
    {
      "type": "color",
      "id": "bg",
      "label": "Background Color"
    },
    {
      "type": "text",
      "id": "title",
      "label": "Heading"
    },
       {
          "type": "text",
          "id": "button_label",
          "label": "Button label",
          "default": "Shop All Products"
        },
        {
          "type": "url",
          "id": "button_link",
          "label": "Link"
        },
    {
      "type" : "checkbox",
      "id" : "use_cart_btn",
      "label" : "Show Add to cart button",
      "default" : false
    },
    {
      "type" : "checkbox",
      "id" : "hide_on_mobile",
      "label" : "Hide on Mobile",
      "default" : false
    },
    {
      "type": "select",
      "id": "align_text",
      "label": "Alignment",
      "default": "center",
      "options": [
        {
          "value": "left",
          "label": "Left"
        },
        {
          "value": "center",
          "label": "Centered"
        },
        {
          "value": "right",
          "label": "Right"
        }
      ]
    },
    {
      "type": "checkbox",
      "id": "divider",
      "label": "Show section divider",
      "default": false
    }
  ],
  "blocks": [
    {
      "type": "text_block",
      "name": "Column",
      "settings": [
        {
          "type": "checkbox",
          "id": "enable_image",
          "label": "Show image",
          "default": true
        },
        {
          "type": "image_picker",
          "id": "image",
          "label": "Image"
        },
        {
          "type": "range",
          "id": "image_width",
          "label": "Image width",
          "default": 650,
          "min": 60,
          "max": 650,
          "step": 10,
          "unit": "px"
        },
        {
          "type": "text",
          "id": "title",
          "label": "Heading",
          "default": "Example title"
        },
        {
          "type": "richtext",
          "id": "text",
          "label": "Text",
          "default": "<p>Use this section to explain a set of product features, to link to a series of pages, or to answer common questions about your products. Add images for emphasis.</p>"
        },
        {
          "type": "text",
          "id": "button_label",
          "label": "Button label",
          "default": "Optional button"
        },
        {
          "type": "url",
          "id": "button_link",
          "label": "Link"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Text columns with images",
      "blocks": [
        {
          "type": "text_block"
        },
        {
          "type": "text_block"
        },
        {
          "type": "text_block"
        }
      ]
    }
  ]
}
{% endschema %}
